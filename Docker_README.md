# Задание 2 (Docker)

## Файлы

- `src/entrypoint.sh` -- начальный скрипт для контейнера, который
  обрабатывает данные в третьем задании.

## Краткое описание задания

Необходимо запаковать в образ Docker актуальные версии следующих
приложений:

1. samtools + htslib + libdeflate;
2. bcftools;
3. vcftools;

- Базовый образ -- `ubuntu:22.04`;
- Все специальные пакеты должны быть собраны самому;
- Программы должны быть установлены в свои папки и быть доступны из
  переменной `PATH`
  
  
## Описание Dockerfile

Dockerfile использует multi-stage сборку. В финальный образ перенесены
только исполняемые файлы требуемых программ (при необходимости, можно
добавить к ним что-то ещё).

Библиотеки htslib и libdeflate в конечном образе установлены в
директорию `/usr/local`, чтобы там линковщик их нашел и программы
запускались без проблем. Для проверки, [внутри
контейнера](https://github.com/rustbas/biodocker/blob/main/FP_SNPs_README.md#%D1%81%D0%B2%D1%8F%D0%B7%D0%BA%D0%B0-%D1%81-docker)
можно воспользоваться командой `ldd` и увидеть все динамические
зависимости исполняемых файлов.

## Особенности

- Созданы переменные окружения для каждого тула: `$SAMTOOLS`,
  `$BCFTOOLS`, `$VCFTOOLS`;
- Задана переменная окружения `$SOFT` равная `/soft` -- директории со
  всеми тулами;
  
  
## Сборка и проверка

Для сборки образа, нужно ввести команду, находясь в корневой директории:
```console
foo@bar:~$ docker build -t biodocker .
```

Чтобы запустить и подключиться к контейнеру:
```console
foo@bar:~$ docker run --rm -it biodocker
```

Или можно запустить скрипт пайплайна без аргументов:
```console
foo@bar:~$ ./pipeline.sh
```
